import{a as j,b as H,c as E,d as z,e as Y,f as $,g as L,h as q,i as K,j as G}from"./chunk-IJLSDXEQ.js";import{a as F}from"./chunk-UKWC5RQE.js";import"./chunk-HPUORIJ7.js";import"./chunk-TXUFLIE5.js";import{$ as N,B as w,D as g,E as x,H as R,N as S,T as h,U as v,V as y,X as P,Z as B,ba as O,ga as k,ka as A,o as _}from"./chunk-UREYUQAJ.js";import{a as s,b as l,c as V,e as T}from"./chunk-ACKELEN3.js";var U=0;function rt(){let a=g([]),i=g([]);function r(e){a.update(t=>[e,...t])}function n(e){let M=e,{message:t}=M,o=V(M,["message"]),u=typeof e?.id=="number"||e.id&&e.id?.length>0?e.id:U++,m=e.dismissible??!0,d=e.type??"default";return a().find(b=>b.id===u)?a.update(b=>b.map(C=>C.id===u?l(s(s({},C),e),{id:u,title:t,dismissible:m,type:d,updated:!0}):l(s({},C),{updated:!1}))):r(l(s({},o),{id:u,title:t,dismissible:m,type:d})),u}function p(e){if(e===void 0){a.set([]);return}return a.update(t=>t.filter(o=>o.id!==e)),e}function W(e,t){return n(l(s({},t),{type:"default",message:e}))}function Q(e,t){return n(l(s({},t),{type:"error",message:e}))}function Z(e,t){return n(l(s({},t),{type:"success",message:e}))}function X(e,t){return n(l(s({},t),{type:"info",message:e}))}function J(e,t){return n(l(s({},t),{type:"warning",message:e}))}function tt(e,t){return n(l(s({},t),{type:"loading",message:e}))}function et(e,t){if(!t)return;let o;t.loading!==void 0&&(o=n(l(s({},t),{promise:e,type:"loading",message:t.loading})));let u=e instanceof Promise?e:e(),m=o!==void 0;return u.then(d=>{if(d&&typeof d.ok=="boolean"&&!d.ok){m=!1;let f=typeof t.error=="function"?t.error(`HTTP error! status: ${d.status}`):t.error;n({id:o,type:"error",message:f})}else if(t.success!==void 0){m=!1;let f=typeof t.success=="function"?t.success(d):t.success;n({id:o,type:"success",message:f})}}).catch(d=>{if(t.error!==void 0){m=!1;let f=typeof t.error=="function"?t.error(d):t.error;n({id:o,type:"error",message:f})}}).finally(()=>{m&&(p(o),o=void 0),t.finally?.()}),o}function nt(e,t){let o=t?.id??U++;return n(s({component:e,id:o},t)),o}function ot(e){i.update(t=>t.filter(o=>o.toastId!==e))}function it(e){i.update(t=>[e,...t].sort(at))}let at=(e,t)=>a().findIndex(o=>o.id===e.toastId)-a().findIndex(o=>o.id===t.toastId);function st(){a.set([]),i.set([])}return{create:n,addToast:r,dismiss:p,message:W,error:Q,success:Z,info:X,warning:J,loading:tt,promise:et,custom:nt,removeHeight:ot,addHeight:it,reset:st,toasts:a.asReadonly(),heights:i.asReadonly()}}var c=rt();function lt(a,i){return c.create(s({message:a},i))}var dt=lt,D=Object.assign(dt,{success:c.success,info:c.info,warning:c.warning,error:c.error,custom:c.custom,message:c.message,promise:c.promise,dismiss:c.dismiss,loading:c.loading});var I=class a{_formBuilder=_(K);_entryService=_(F);_router=_(A);loading=g(!1);id=w.required();form=this._formBuilder.group({content:this._formBuilder.control("",E.required),marker:this._formBuilder.control(!1,E.required)});constructor(){k(()=>{let i=this.id();i&&this.getTask(i)})}submit(){return T(this,null,function*(){if(!this.form.invalid)try{this.loading.set(!0);let{content:i,marker:r}=this.form.value,n={content:i||"",marker:!!r},p=this.id();p?yield this._entryService.update(n,p):yield this._entryService.create(n),D.success(`Task ${p?"updated":"created"} `),this._router.navigateByUrl("/entries")}catch(i){D.error("An error ocurred "+i)}finally{this.loading.set(!1)}})}getTask(i){return T(this,null,function*(){let r=yield this._entryService.getEntry(i);if(!r.exists())return;let n=r.data();this.form.patchValue(n)})}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=R({type:a,selectors:[["app-entry-form"]],inputs:{id:[1,"id"]},features:[O([F])],decls:14,vars:3,consts:[[1,"add-entries"],[1,"",3,"ngSubmit","formGroup"],["for","content",1,""],["cols","44","rows","12","type","text","name","content","id","content","formControlName","content",1,""],[1,""],["type","checkbox","value","","formControlName","marker",1,""],["type","submit",1,"",3,"disabled"]],template:function(r,n){r&1&&(h(0,"div",0)(1,"form",1),P("ngSubmit",function(){return n.submit()}),h(2,"div"),y(3,"label",2)(4,"textarea",3),v(),y(5,"br"),h(6,"div")(7,"label",4),y(8,"input",5),h(9,"span",4),B(10," \u0410\u043D\u0433\u0435\u043B-\u0445\u0440\u0430\u043D\u0438\u0442\u0435\u043B\u044C"),v()()(),y(11,"br"),h(12,"button",6),B(13),v()()()),r&2&&(x(),S("formGroup",n.form),x(11),S("disabled",n.form.invalid||n.loading()),x(),N(" ",n.loading()?"\u0421\u043E\u0445\u0440\u0430\u043D\u044F\u0435\u043C...":"\u0413\u043E\u0442\u043E\u0432\u043E"," "))},dependencies:[G,$,H,j,z,Y,L,q],encapsulation:2})};export{I as default};
